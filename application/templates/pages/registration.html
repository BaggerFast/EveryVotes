{% extends 'app.html' %}
{% block content %}
  <h1>Registration</h1>
  <form id="app" ref="form" @submit="checkForm" method="post">
    {% csrf_token %}
    <div style="margin-top: 20px;">
      <div v-for="error in errors" class="alert alert-danger" role="alert">
        [[ error ]]
      </div>
    </div>
    <div class="mb-3">
      <label for="exampleInputFirstName" class="form-label">First name</label>
      <input type="text" class="form-control" id="exampleInputFirstName" name="first_name" v-model="first_name">
    </div>
    <div class="mb-3">
      <label for="exampleInputLastName" class="form-label">Last name</label>
      <input type="text" class="form-control" id="exampleInputLastName" name="last_name" v-model="last_name">
    </div>
    <div class="mb-3">
      <label for="exampleInputUsername" class="form-label">Username</label>
      <input type="text" class="form-control" id="exampleInputUsername" name="username" v-model="username">
    </div>
    <div class="mb-3">
      <label for="exampleInputPassword" class="form-label">Password</label>
      <input type="password" class="form-control" id="exampleInputPassword" name="password" v-model="password">
    </div>
    <div class="mb-3">
      <label for="exampleInputRepeatPassword" class="form-label">Repeat password</label>
      <input type="password" class="form-control" id="exampleInputRepeatPassword" v-model="repeat_password">
    </div>
    <button type="submit" class="btn btn-primary">Register</button>
  </form>
  <script>
    const app = new Vue({
      el: '#app',
      delimiters: ['[[', ']]'],
      data: {
        errors: [],
        first_name: '',
        last_name: '',
        username: '',
        password: '',
        repeat_password: ''
      },
      methods: {
        checkForm: function (e) {
          if (this.first_name.length > 3 && this.first_name.length < 12 &&
          this.last_name.length > 3 && this.last_name.length < 15 &&
          this.username.length > 4 && this.username.length < 12 &&
          this.password.length > 4 && this.password.length < 30 &&
          this.password == this.repeat_password) {
            return true;
          }
          this.errors = [];
          if (this.first_name.length <= 3) {
            this.errors.push('First name length must be greater than 3.');
          } else {
            if (this.first_name.length >= 12) {
              this.errors.push('First name length must be less than 12.');
            }
          }
          if (this.last_name.length <= 3) {
            this.errors.push('Last name length must be greater than 3.');
          } else {
            if (this.last_name.length >= 15) {
              this.errors.push('Last name length must be less than 15.');
            }
          }
          if (this.username.length <= 4) {
            this.errors.push('Username length must be greater than 4.');
          } else {
            if (this.username.length >= 12) {
              this.errors.push('Username length must be less than 12.');
            }
          }
          if (this.password.length <= 4) {
            this.errors.push('Password length must be greater than 4.');
          } else {
            if (this.password.length >= 30) {
              this.errors.push('Password length must be less than 30.');
            }
          }
          if (this.password != this.repeat_password) {
            this.errors.push('Incorrect password pair.');
          }
          e.preventDefault();
        }
      }
    })
  </script>
{% endblock %}
